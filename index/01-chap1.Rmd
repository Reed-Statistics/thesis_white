# Context {#context}

It is of interest of national forest inventories such as the United States Forest Inventory and Analysis Program (FIA) to be able to provide reliable estimates of forest attributes in small domains such as ecological subsections (often referred to as ecosubsections) or counties. In particular, the FIA would like to have estimates with low variance in ecological subsections, however, the FIA only samples a small numbers of plots in these small areas. The research goal of this thesis is to address this problem by using techniques which seek to minimize variance of estimates while only introducing a small amount of bias. Having precise estimates of forest attributes at the ecosubsection level is crucial for educational programs and implementation of programs which seek to maintain the health of our forests.

In order to produce these estimates of forest attributes, we must perform small area estimation. But what is small area estimation? Small area estimation is a branch of survey statistics which includes techniques that allow us to estimate the value of parameters at a sub-population level. Typically in survey estimation, we are interested in doing inference at a population level, however we are sometimes interested in attaining estimates for sub-populations or "small areas." We can visualize the process of performing estimation at the sub-population level by considering an ecological province divided into three ecosubsections, each of which have sampled areas:
```{r ecological-province-diagram, fig.align="center", out.width='100%', echo = FALSE, fig.cap="An Ecological Province"}
knitr::include_graphics("figure/ecoprov-diagram.png")
```
As stated before, we are interested in performing inference at the sub-population level. Therefore we are interested in learning about the value of forest attributes in the blue, orange, and green areas. There are are wide range of techniques that can be used to carry out the small area estimation of forest attributes. Broadly, these methods fall into three categories: direct estimators, indirect estimators, and model-based estimators. These are all methods of small area estimation, as they are all attempting to do inference at the sub-population level, however, they are quite different from each other. 

Direct estimators are defined as those that rely only on the samples within the small area which we would like to measure. Some examples of a direct estimator are the mean of a variable, or the post-stratified estimate of a variable. The post-stratified estimate is similar to the mean, however it accounts for under- and over-sampling of forested areas in a given sub-population. These estimates do not rely on information outside of the small area being estimated, however, the post-stratified estimator uses auxiliary information such as the true proportion of forested land within the small area to produce estimates. Direct estimation is the simplest kind of small area estimator as it only relies on samples within the sub-population of interest to produce its estimates. We can visualize these two estimators to get a better sense of their estimation process by considering how they would estimate some $y$ variable in our green sub-population $j$ from Figure \@ref(fig:ecological-province-diagram). 
```{r mean-diagram, fig.align="center", out.width='100%', echo = FALSE, fig.cap="The mean as a direct estimator"}
knitr::include_graphics("figure/mean-diagram.png")
```
```{r ps-diagram, fig.align="center", out.width='100%', echo = FALSE, fig.cap="The post-stratified direct estimator"}
knitr::include_graphics("figure/ps-diagram.png")
```



The second kind of estimator, indirect estimators, rely on data outside of the area of interest to produce their estimate, however they do not rely on auxiliary data. With indirect estimators, we can use information (or "borrow strength") from nearby small areas to help improve our estimate in our area of interest through implicit use of a model. These indirect estimators are quite a bit more complicated than direct estimators due to the fact that they borrow strength, however, they often significantly reduce variance in estimates due to the added information from other sub-populations. Finally, model-based estimators are those which both borrow strength from other small areas and use auxiliary information to compute the estimate of interest. These estimators are still within the family of indirect estimators, but make explicit use of a model. Similarly to the indirect estimators discussed previously, these models can further reduce the variance of our estimates because they allow for more information to be used in the estimate. We can further categorize these explicit model-based estimators into two classes, unit-level and area-level models. Unit-level models consider information at the level of which the data was collected. Area-level models consider information that has been aggregated to the level of a small area before the model is fit to the data. 

A small area estimation technique that has been increasing in popularity in the realm of applications to the FIA and forestry data in general is model-based estimation. As the FIA requires a reduction in variance for their estimates of increasingly smaller areas, it becomes inevitable that borrowing strength from surrounding areas and the use of auxiliary data is needed to maintain a satisfactory amount of variance. Commonly, frequentist model-based estimators are used for model-based small area estimation, such as the empirical best linear unbiased prediction (EBLUP) estimator. Models such as the EBLUP have some very nice properties, most notably, they are "unbiased" if the assumed model is correct. This means that, given the modeling assumptions are met, our parameter estimate for each sub-population will have the following property:
$$
E[\hat \theta_i] - \theta_i = 0.
$$
That is, the expected value of the statistic, $\hat \theta_i$, is in fact the parameter of interest. It is clear as to why this is a trait we would want in our model and to why it is so commonly used, however, what is not clear is the cost of this trait. By only focusing on reducing the bias in our estimates, we must ignore the second piece of the mean squared error, the variance. While it is important for bias to be low, we can often reduce our mean squared error by a large amount by increasing bias slightly, as bias and variance are inversely related. 

This thesis attempts to do just that. We implement hierarchical Bayesian unit- and area-level models which allow for the estimates to be slightly biased while reducing variance. Throughout this thesis, we compare these techniques to small area estimations techniques such as the EBLUP and the post-stratified direct estimator. By applying these models on four response variables across the entire Interior West, we can add a great deal of understanding to the usefulness of hierarchical Bayesian models in a small area estimation context, especially when considering its usefullness to the FIA and other forestry organizations. We only have been able to source one paper which uses hierarhical Bayesian modeling for small area estimation with a forestry application, and they only consider the area-level model with a particular response variable in particular forest [@ver2017]. This thesis thus adds significantly to our understanding of the usefulness of hierarchical Bayesian small area estimation in a forestry setting due to the introduction of the unit-level model, the vast number of response variables studied, and the vast range of area where we test the usefulness of this model. 

<!-- *provides background material on the topic and other approaches, and identifies what is added by this thesis* -->
<!-- To implement these models, there are two statistical schools of thought: frequentist methods and Bayesian methods. Frequentist models are the most common for estimation of forest attributes in small area estimation [CITE LOTS OF PAPERS HERE]. However, Bayesian methods have been used at the area-level for small area estunation of of forest attributes [@ver2017]. While frequentist methods are often viewed as the "default" method for doing small area estimation, there are many benefits of tackling these problems from a Bayesian perspective. Notably, Bayesian estimation utilizes prior distributions which allow us to quantify our prior uncertainty about the values of each parameter.  -->